type Vulnerability = {
  id: string;
  modified: string;
};

type Package = {
  pkg: string;
  version: string;
  vulnerabilities: Vulnerability[];
};

type VulnerabilityListProps = {
  packages: Package[];
};

export const VulnerabilitiesList: React.FC<VulnerabilityListProps> = ({
  packages,
}) => (
  <div className='flex flex-col gap-5'>
    <h2>Some vulnerabilities were found:</h2>

    <div className='flex flex-col gap-7 bg-white p-5 rounded-lg shadow-md'>
      {packages.map((pkg) => (
        <div key={pkg.pkg} className='flex flex-col gap-1 '>
          <p>
            Package name: <b>{pkg.pkg}</b>
          </p>
          <p>
            Package version:{' '}
            <span className='bg-yellow-100 text-yellow-700 rounded p-1'>
              {pkg.version}
            </span>
          </p>
          <p className='my-3'>Vulnerabilities:</p>
          <ul className='flex flex-col gap-1'>
            {pkg.vulnerabilities.map((vuln) => (
              <li
                key={vuln.id}
                className='bg-red-100 text-red-700 font-bold p-1 rounded text-center'
              >
                <a
                  href={`https://github.com/advisories/${vuln.id}`}
                  target='_blank'
                  rel='noopener noreferrer'
                >
                  {vuln.id}
                </a>
              </li>
            ))}
          </ul>
        </div>
      ))}
    </div>
  </div>
);
